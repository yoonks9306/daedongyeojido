# QA_RUN_2026-02-18

Run date: 2026-02-18  
Operator: Codex (GPT-5)  
Environment: local code review + build verification

## 1) Build Gate

- `npm run build`: PASS
- Route generation: 63 routes
- Proxy registration: PASS (`Æ’ Proxy (Middleware)`)

## 2) Frozen Decision Checks

### Q-001 Pending revision visibility (Critical)
- Status: `Code PASS` / `Staging runtime pending`
- Evidence:
  - Pending status assignment in update path: `src/app/api/v1/wiki/articles/[slug]/route.ts:137`
  - Non-active revision returns pending response without article overwrite: `src/app/api/v1/wiki/articles/[slug]/route.ts:157`
  - Public read path uses `wiki_articles` table (active body source): `src/app/wiki/[slug]/page.tsx:66`

### Q-002 Role-first destructive authority (Critical)
- Status: `Code PASS` / `Staging runtime pending`
- Evidence:
  - Report resolution staff-only guard: `src/app/api/v1/reports/[id]/route.ts:38`
  - Upload block transition staff-only guard: `src/app/api/v1/uploads/[id]/route.ts:83`

### Q-003 Admin master scope (Critical)
- Status: `Code PASS` / `Staging runtime pending`
- Evidence:
  - Emergency-lock admin-only GET/PATCH gate: `src/app/api/v1/admin/settings/emergency-lock/route.ts:22`
  - Non-admin rejection path: `src/app/api/v1/admin/settings/emergency-lock/route.ts:23`

### Q-004 Upload strategy A in-scope (High)
- Status: `Code PASS` / `Staging runtime pending`
- Evidence:
  - MIME allowlist enforcement: `src/app/api/v1/uploads/route.ts:10`
  - 5MB cap and size validation: `src/app/api/v1/uploads/route.ts:11`
  - Daily quota enforcement: `src/app/api/v1/uploads/route.ts:27`

### Q-005 Account deletion policy (High)
- Status: `Code PASS` / `Staging runtime pending`
- Evidence:
  - Soft-delete endpoint: `src/app/api/v1/account/delete/route.ts:12`
  - Write-path deleted/banned guard: `src/lib/community-auth-user.ts:63`
  - Sign-in block for deleted/banned identities: `src/auth.ts:43`

### Q-006 Optimistic locking (Critical)
- Status: `Code PASS` / `Staging runtime pending`
- Evidence:
  - Base revision mismatch returns `409`: `src/app/api/v1/wiki/articles/[slug]/route.ts:129`
  - Conflict payload includes `currentRevisionNumber`: `src/app/api/v1/wiki/articles/[slug]/route.ts:132`

## 3) Security/Abuse Checks

### S-001 Emergency lock write-stop (Critical)
- Status: `Code PASS` / `Staging runtime pending`
- Evidence:
  - Shared write guard: `src/lib/emergency-lock.ts:22`
  - Applied to reports write route: `src/app/api/v1/reports/[id]/route.ts:65`
  - Applied to uploads write route: `src/app/api/v1/uploads/route.ts:20`

### S-002 Dual rate limit (High)
- Status: `Code PASS` / `Staging runtime pending`
- Evidence:
  - Edge throttling rules: `src/proxy.ts:12`
  - 429 response with retry headers: `src/proxy.ts:55`

### S-003 RLS hardening (Critical)
- Status: `DB migration applied by owner` / `SQL verification pending`
- Evidence:
  - Hardened policy migration file: `supabase/migrations/2026-02-18-architecture-final-batch-4-security-hardening.sql:6`

## 4) Remaining Manual Actions (to close AX-QA-001)

1. Run `QA_RELEASE_GATE.md` staging steps for Q-001..Q-006 and S-001..S-003.
2. Execute SQL verification queries in Supabase SQL Editor.
3. Fill final sign-off block in `QA_RELEASE_GATE.md`.

## 5) Gate Decision (Current)

- Release Gate: `NOT READY`
- Reason:
  - Required staging runtime checks not fully executed.
